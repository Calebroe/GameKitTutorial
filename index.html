<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>GameKitTutorial</title>
  <link rel="stylesheet" href="css/styles.css">
  <!-- Include the PrismJS stylesheet for styling -->
  <link href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism-okaidia.css" rel="stylesheet"/>
  <!-- Include PrismJS and the language-specific component -->
  <script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-swift.min.js"></script>
</head>
<body>
  <nav>
    <div class="start">
      <a href="#">Caleb Roe | Cody Peyerk</a>
    </div>
    <div class="end">
      <a href="#introduction">Introduction</a>
      <a href="#overview">Overview</a>
      <a href="#integration">Integration</a>
      <a href="#leaderboards">Leaderboards</a>
      <a href="#achievements">Achievements</a>
      <a href="#references">References</a>
    </div>
  </nav>
  <main class="single-article-container">
    <div class="meta-container">
      <img class="avatar" src="assets/img/Caleb_Roe.jpeg" alt="Caleb Roe">
      <img class="avatar" src="assets/img/codypeyerk.jpg" alt="Cody Peyerk">
      <div class="post-meta">
        <p class="author">Caleb Roe | Cody Peyerk</p>
        <p class="date">Dec 8, 2023 · 20 min read</p>
      </div>
    </div>
    <div class="article-container">
      <section id="introduction">
        <h2>Introduction</h2>
        <br>
        <p class="content">
        <img src="assets/img/gamecenter.png" alt="Game Center">
        <br>
        GameKit enriches iOS games by enabling social gaming features. 
        It's crucial for engaging users in a more interactive and competitive environment. 
        For a game like 2048, GameKit can significantly enhance the gaming experience 
        by adding a social dimension through leaderboards and achievements, 
        motivating players to improve their skills and engage more deeply with the game.
        <br>
        <br>
        The 2048 game, a simple yet addictive puzzle, will integrate GameKit to enhance user 
        engagement through the Game Center. We'll add achievements for reaching key milestones 
        (like achieving the 2048 tile), and leaderboards to foster a competitive environment. 
        This will not only increase the game’s replayability but also leverage the social aspect 
        of gaming by allowing players to compare their scores with friends and the global player base.
        </p>
        <br>
        <br>
      </section>
      <section id="overview">
        <h2>Overview</h2>
        <br>
        <p class="content">
        This section will delve into the specifics of adding GameKit features to the 2048 game, 
        demonstrating how to make a simple game more engaging and competitive.
        </p>
        <br>
        <h3>Getting Started</h3>
        <br>
        <p class="content">
          We'll use the latest Xcode version and Swift 5, targeting iOS 14 and above. 
          We'll guide you through setting up GameKit in your project, 
          ensuring you have all the necessary tools and dependencies installed.
          <br>
          In order to add Game Center to your app you will first need to create an app on App Store Connect. 
          This will require that you have an Apple Developer account. Once you have logged in you will go 
          to the “My Apps” section and create a new app. In this creation you will link the app using 
          your unique “bundle identifier” which you can find inside your XCode project under “Signing & Capabilities.
          <br>
          <br>
          <img src="assets/img/xcode_signup.PNG" alt="XCode Sign in">
          <br>
          While creating your app, make sure to give it permissions for “Game Center”. 
          For the purposes of this tutorial the app will require no other permissions other than Game Center.
          <br>
          <br>
          Now that your app has been created you will need to add Game Center to the app itself inside of Xcode. 
          To do this you will again go to the “Signing & Capabilities” page under your project. Once here you will 
          need to click on the “Team” dropdown menu and, if you haven’t added your account yet, you will need to 
          add your account. After your account has been added you will need to select it in this dropdown menu. 
          Now, you will click on the “+ Capability” button which can be found near the top-left of the image above.
          <br>
          <br>
          <img src="assets/img/xcode_signup_2.PNG" alt="XCode Sign in">
          <br>
          This will bring up the capabilities search menu. You can either scroll through the options and find “Game Center” 
          or you can search for it using the search bar. Once you locate it you will double click on it and that will add 
          it to your project. Now you will be able to utilize GameKit inside of your project.
          <br>
          <br>
        </p>
      </section>
      <section id="integration">
        <h2>Integration</h2>
        <p class="content">
        <br>
        For ease of access we recommend putting the Game Center code in its own file and class. 
        This step is optional but will make the code much more readable and clean. You will then be able 
        to create @StateObject variables of the class in the other files that need to access the functions and data. 
        The class will need to be of type ObservableObject and can be outlined like so:
        <br>
        <br>
        <pre><code class="language-swift">
          class GameCenterHandler: ObservableObject {}          
        </code></pre>
        <br>
        When creating a separate class for all of the Game Center handling like this 
        it is important  to make sure that only a single instance of the class is created 
        and passed around. To accomplish this we will create a singleton like so:
        <br>
        <br>
        <pre><code class="language-swift">
          static let shared = GameCenterHandler()         
        </code></pre>
        <br>
        This “shared” variable will allow us to access this single instance of the GameCenterHandler class. 
        From here we will need two more variables before we can authenticate our player. Those being a variable
        containing the local player themself and a variable of type @Published to track whether the 
        authentication view needs to be presented. This can be done like so:
        <br>
        <br> 
        <pre><code class="language-swift">
          var localPlayer = GKLocalPlayer.local
          @Published var isPresentingAuthView = false
        </code></pre>
        <br> 
        From here we are now ready to authenticate the local player. This is done using 
        the GKLocalPlayer.local instance property of “.authenticateHandler”. The authenticateHandler 
        takes a completionHandler that gives two parameters with them being a viewController and an error. 
        The viewController will have a value containing the view for the Game Center authentication if the 
        user is not authenticated and a value of nil if they are authenticated. Likewise, the error will 
        have a value if there is an error or nil if there is none. We can assign this property inside of the init() function like so:
        <br>
        <br> 
        <pre><code class="language-swift">
          var localPlayer = GKLocalPlayer.local
          @Published var isPresentingAuthView = false
        </code></pre>
        <br>
        From here we are now ready to authenticate the local player. This is done using the GKLocalPlayer.local
        instance property of “.authenticateHandler”. The authenticateHandler takes a completionHandler that 
        gives two parameters with them being a viewController and an error. The viewController will have a 
        value containing the view for the Game Center authentication if the user is not authenticated and a 
        value of nil if they are authenticated. Likewise, the error will have a value if there is an error 
        or nil if there is none. We can assign this property inside of the init() function like so:
        <br>
        <br> 
        <pre><code class="language-swift">
          init() {
            localPlayer.authenticateHandler = { viewController, error in
                if viewController != nil {
                    // Set value to present view controller to authenticate user
                    GameCenterHandler.shared.isPresentingAuthView = true
                } else if self.localPlayer.isAuthenticated {
                     // Player is authenticated
                } else {
                    // Handle error
                    print(error?.localizedDescription ?? "")
                    return
                }
            }
        }    
        </code></pre>
        <br>
        There are four main states we need to check for inside of the authenticateHandler, 
        with those being: if the viewController is not null, if the user is authenticated, 
        if the user isn’t authenticated, and if there is an error. The first is so we can 
        set the flag variable we created earlier to true in order to bring up the Game Center
        authentication view. Next, we check if the player is authenticated or not and inside 
        of this check we can check for if the user has some restrictions placed on their Game 
        Center account. These restrictions can be things like multiplayer restrictions or social 
        restrictions. Next, we check if the player is not authenticated. In this we can choose to 
        warn the user or limit game functionality or force them to retry. Finally, we check to see 
        if there is an error and handle it properly. The order of these checks are somewhat 
        interchangeable but in general you should check for the viewController before checking 
        if the user is authenticated. You may also omit some of them if you have no need to do 
        anything more inside of the check such as how the check for if the player is authenticated 
        is empty in the example code above.
        <br>
        <br>
        </p>
      </section>
      <section id="leaderboards">
        <h2>Leaderboards</h2>
        <p class="content">
          <!-- References content goes here -->
        </p>
      </section>
      <section id="achievements">
        <h2>Achievements</h2>
        <p class="content">
          <!-- References content goes here -->
        </p>
      </section>
      <section id="references">
        <h2>References</h2>
        <p class="content">
          <!-- References content goes here -->
        </p>
      </section>
    </div>
  </main>
  <footer>
    <a href="#">
      © 2023 Caleb Roe
    </a>
    <div>
      <a href="#">Github</a>
      <a href="#">Linkedin</a>
      <a href="#">E-mail</a>
    </div>
  </footer>
</body>
</html>
